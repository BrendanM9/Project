<!DOCTYPE html>
<html>
    <head>
        <title>Central Oregon Weather</title>
        <link rel="icon" type="image/x-icon" href="favicon.ico">
        <link rel="stylesheet" href="radio.css">
    </head>
    <body>
        <h1>Central Oregon Weather</h1>
        <h3>Keep track of your Central Oregon weather here!</h3>
        <p id='location'></p>
        <p id="demo"></p>
        <p id='description'></p>
        <p id="icon"></p>
        <p id="temp"></p>
        <p id="realFeel"></p>
        <p id="lo"></p>
        <p id="hi"></p>
        <p id="humid"></p>
        <p id="wspeed"></p>
        <p id="degrees"></p>
        <p id="cloud"></p>
    <script>
        const bendID = 5713587;
        const apiKey= '4652a98c9359bbc737bd4e7e8797adfc';
        console.log("working");
        function drawWeather( d ){
            console.log("Weather data \n", d);
            var celsius = Math.round(parseFloat(d.main.temp)-273.15);
            var fahrenheit = Math.round(((parseFloat(d.main.temp)-273.15)*1.8)+32);
            var heatIndexF = Math.round(((parseFloat(d.main.feels_like)-273.15)*1.8)+32);
            var low= Math.round(((parseFloat(d.main.temp_min)-273.15)*1.8)+32);
            var high= Math.round(((parseFloat(d.main.temp_max)-273.15)*1.8)+32);
            var speed= Math.round(parseFloat(d.wind.speed)*0.62137119);

            document.getElementById('description').innerHTML = "Description: "+ d.weather[0].description;
            document.getElementById('icon').innerHTML = d.weather[0].icon;
            document.getElementById('temp').innerHTML = "Current Temperature: " + fahrenheit + '&deg;';
            document.getElementById('location').innerHTML = "Location: " + d.name;
            document.getElementById('realFeel').innerHTML = "Real Feel: "+ heatIndexF + '&deg';
            document.getElementById('lo').innerHTML = "Minimum Temperature So Far: " +low + '&deg';
            document.getElementById('hi').innerHTML = "Maximum Temperature So Far: " +high + '&deg';
            document.getElementById('humid').innerHTML = "Humidity: " + d.main.humidity + '%';
            document.getElementById('wspeed').innerHTML= "Wind Speed: " + speed + " Miles Per Hour";
            document.getElementById('degrees').innerHTML = "Wind Direction: "+ d.wind.deg + '&deg';
            document.getElementById("cloud").innerHTML = "Cloud Cover: " + d.clouds.all + '%';
        }

        function weatherBalloon( cityID ){
            var key = apiKey;
            fetch('https://api.openweathermap.org/data/2.5/weather?id='+cityID+'&appid=' + key)
            .then(function(resp) { return resp.json() }) // Convert data to JSON
            .then(function(data) {
                drawWeather(data); // Call drawWeather
            })
            .catch(function(){
                // catch any errors
            });
        }
        window.onload = function() {
            weatherBalloon(bendID);
        }
    </script>
    <div id="mySidenav" class="sidenav">
        <br>
        <br>
        <a href="index.html" id="home">Home</a>
        <a href="about.html" id="about">About</a>
        <a href="weather.html" id="weather">Weather</a>
        <a href="request.html" id="request_line">Song Request</a>
        <a href="contact.html" id="contact">Contact</a>
      </div>
    </body>
</html>
